adapter driver jlink
transport select jtag

reset_config trst_and_srst
set _CHIPNAME K1921VG5T

jtag newtap $_CHIPNAME cpu -irlen 5 -expected-id 0xDEB14001

set _DAPNAME $_CHIPNAME.dap
set _TARGETNAME $_CHIPNAME.cpu

target create $_TARGETNAME riscv -endian little -chain-position $_TARGETNAME -coreid 0
	
proc k1921vg5t_clk_init { } {
  adapter speed 100
  mww 0x50004020 0x01
  sleep 1000
  adapter speed 1000
}

proc k1921vg5t_clk_pll_init { } {
  adapter speed 200
  mww 0x50004020 0x01
  mww 0x50004044 0x6401e012
  mww 0x5000404c 0x1
  mww 0x50004048 0x1
  mww 0x50004040 0x00013004
  sleep 1
  mww 0x50004020 0x02
  adapter speed 8000
}

$_TARGETNAME configure -event reset-init {k1921vg5t_clk_pll_init}
#$_TARGETNAME configure -event reset-init {k1921vg5t_clk_init}

init 
reset init
